<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <table>
    <tr>
      <th>姓名</th>
      <th>性别</th>
      <th>职业</th>
      <th>毕业院校</th>
    </tr>
    <tr>
      <td>王如斌</td>
      <td>男</td>
      <td>web前端工程师</td>
      <td>武汉职业技术学院</td>
    </tr>
    <tr>
      <td>杨亚东</td>
      <td>男</td>
      <td>化学合成师</td>
      <td>岳阳理工学院</td>
    </tr>
    <tr>
      <td>刘新龙</td>
      <td>男</td>
      <td>大数据分析师</td>
      <td>齐鲁理工大学</td>
    </tr>
    <tr>
      <td>吴迪</td>
      <td>男</td>
      <td>web前端工程师</td>
      <td>武汉职业技术学院</td>
    </tr>
    <tr>
      <td>田博虎</td>
      <td>男</td>
      <td>web前端在线炒面大师</td>
      <td>武大汉学</td>
    </tr>
  </table>
  <button>点击下载excel文件</button>
  <script>
    const downloadByContent = (content, filename, type) => {
      const aTag = document.createElement('a');
      aTag.download = filename;
      const blob = new Blob([content], { type });
      const blobUrl = URL.createObjectURL(blob);
      aTag.href = blobUrl;
      aTag.click();
      URL.revokeObjectURL(blob);
    }
    const template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" '
      + 'xmlns:x="urn:schemas-microsoft-com:office:excel" '
      + 'xmlns="http://www.w3.org/TR/REC-html40">'
      + '<head>'
      + '</head>'
      + '<body><table border="1" style="width:60%; text-align: center;">{table}</table><\/body>'
      + '<\/html>';
    const context = template.replace('{table}', document.querySelector('table').innerHTML);


    document.querySelector('button').addEventListener('click', () => {
      downloadByContent(context, 'stuinfo123.xls', 'application/vnd.ms-excel');
    })
  </script>
</body>

</html>